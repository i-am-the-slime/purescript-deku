<!DOCTYPE html>
  <html>
    <head>
      <title>Deku documentation</title>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width">
      <link rel="stylesheet" href="../style.css">
      <script type="module">
        import { main } from "../bundle.js";
        main({"startsWith":"SSR","slug":"/purescript-deku/"})();
      </script>
    </head><body data-deku-ssr="deku-root" data-deku-root="deku-root"><div   data-deku-ssr="-648823"><div  data-deku-ssr="-903457"><span  data-deku-ssr="-806914"><a style="cursor:pointer;" href="/purescript-deku/" data-deku-ssr="-710371"><!---613828--></a><span style="" data-deku-ssr="-517285"><!---420742--></span></span><span  data-deku-ssr="-324199"><a style="cursor:pointer;" href="/purescript-deku/hello/" data-deku-ssr="-227656"><!---131113--></a><span style="" data-deku-ssr="-34570"><!--61973--></span></span><span  data-deku-ssr="158516"><a style="cursor:pointer;" href="/purescript-deku/simple/" data-deku-ssr="255059"><!--351602--></a><span style="" data-deku-ssr="448145"><!--544688--></span></span><span  data-deku-ssr="641231"><a style="cursor:pointer;" href="/purescript-deku/pursx1/" data-deku-ssr="737774"><!--834317--></a><span style="" data-deku-ssr="930860"><!---972598--></span></span><span  data-deku-ssr="-876055"><a style="cursor:pointer;" href="/purescript-deku/events1/" data-deku-ssr="-779512"><!---682969--></a><span style="" data-deku-ssr="-586426"><!---489883--></span></span><span  data-deku-ssr="-393340"><a style="cursor:pointer;" href="/purescript-deku/effects/" data-deku-ssr="-296797"><!---200254--></a><span style="" data-deku-ssr="-103711"><!---7168--></span></span><span  data-deku-ssr="89375"><a style="cursor:pointer;" href="/purescript-deku/pursx2/" data-deku-ssr="185918"><!--282461--></a><span style="" data-deku-ssr="379004"><!--475547--></span></span><span  data-deku-ssr="572090"><a style="cursor:pointer;" href="/purescript-deku/events2/" data-deku-ssr="668633"><!--765176--></a><span style="" data-deku-ssr="861719"><!--958262--></span></span><span  data-deku-ssr="-945196"><a style="cursor:pointer;" href="/purescript-deku/portals/" data-deku-ssr="-848653"><!---752110--></a><span style="" data-deku-ssr="-655567"><!---559024--></span></span><span  data-deku-ssr="-462481"><a style="cursor:pointer;" href="/purescript-deku/ssr/" data-deku-ssr="-365938"><!---269395--></a><span style="display:none;" data-deku-ssr="-172852"><!---76309--></span></span></div><!--%-%20234--><div data-deku-ssr="406406" >
  <h1>Server-side rendering</h1>

  <h2>When performance matters!</h2>
  <p>
    In web development, it's good practice to send a plain-HTML version of your site over the wire before any JavaScript starts executing. This is called <i>server-side rendering</i>, or SSR, where the server renders HTML in an initial pass before rendering any JavaScript.
  </p>
  <p>
    The most performant form of SSR is pre-rendering HTML and serving them from memory or from a file system. This is Deku's strategy via the following two functions:
  </p>
  <ul>
    <li><code>runSSR</code> generates HTML; and</li>
    <li><code>hydrate</code> generates JavaScript that will hydrate your HTML with anything that's dynamic. Note that this is <i>partial</i> hydration, meaning it will only hydrate the bits that need hydrating. This means that, for example, you can do CSS animations on load without fear of jank when the JavaScript kicks in.</li>
  </ul>

  <p>
    This documentation is generated using SSR, and if you add <code>view-source:</code> before the URL, you'll see the intro page rendered as HTML. If you're reading this documentation on a computer screen, you won't see much of a difference, but if you're reading it on a 3G mobile network, you'll spot the difference immedaitely.
  </p>

  <h2>A motivating example</h2>

  <p>Here is a small application using SSR. We'll split it up into three files:</p>
  <ul>
    <li><code>App.purs</code> has our application logic.</li>
    <li><code>Build.purs</code> creates a <code>.js</code> file, for example <code>make.js</code>, that will render our HTML.</li>
    <li><code>Live.purs</code> uses hydration to add dynamic logic to the website.</li>
  </ul>

  <h3>App</h3>
  <p>Unlike the previous examples that used <code>runInBody</code>, our application code here has an explicit type annotation <code>Nut</code>. The definition of <code>Nut</code> is <code>type Nut = forall s m lock payload. Korok s m => Domable m lock payload</code>, and in larger projects, you may need to write this type out explicitly, for example if you are working with an <code>Array</code> of <code>Domable</code> and need <code>m</code> to be consistant over the <code>Array</code>.</p>
  <span style="display:contents;" data-deku-elt-internal="code0" data-deku-ssr="code0@!%502949"></span>
  <h3>Build</h3>
  <p>This is the code we use to generate our HTML site. The example below creates a small script that logs our HTML to the command line,but we can also call <code>runSSR</code> from a NodeJS server, in which case we wouldn't <code>log</code> the HTML string but rather we would instead send it over the wire as the response to a request.</p>
  <span style="display:contents;" data-deku-elt-internal="code1" data-deku-ssr="code1@!%502949"></span>
  <h3>Live</h3>
  <p><code>Live.purs</code> can be bundled to generate our dynamic JS. The JS will hydrate our elements instead of replacing them, and will only hydrate elements that potentially will interactive content.</p>
  <span style="display:contents;" data-deku-elt-internal="code2" data-deku-ssr="code2@!%502949"></span>

  <h3>Result</h3>

  <p>Here is the resulting code from our static-site generation. It is rendered dynamically in your browser, but in production settings, we'd use NodeJS to render or pre-render this HTML.</p>

  <span style="display:contents;" data-deku-elt-internal="codegen" data-deku-ssr="codegen@!%502949"></span>

  <p>And here is what the result looks like after hydration.</p>

  <blockquote> <span style="display:contents;" data-deku-elt-internal="result" data-deku-ssr="result@!%502949"></span> </blockquote>

  <p>One important thing to note about SSR is that it leaves a lot of things out. For example, it will not respond to send-to-position requests if they are emitted immediately. These are only evaluated on the client once a document is rendered. For this reason, it is recommended to <i>only</i> use SSR for elements that should be statically rendered, like a loading screen or blog. If you need your initial HTML to reflect lots of inserting and deleting of dynamic nodes, deku SSR may not work for you yet.</p>

  <h2>Parting shot</h2>
  <p>Thanks for checking out Deku! I had a blast writing it, and I hope you enjoy using it for your projects!</p>
</div><!--%-%20234%-%--></div></body></html>
